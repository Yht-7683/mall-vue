webpackJsonp([6],{DKFj:function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={data:function(){return{token:"",visible:!1,imageUrl:"",dialogVisible:!1,disabled:!1,classificationItem:[],dataForm:{id:0,name:"",classification:"",classificationName:"",details:""},dataRule:{name:[{required:!0,message:"商品名不能为空",trigger:"blur"}]}}},methods:{init:function(a){var t=this;this.dataForm.id=a||0,this.token=localStorage.getItem("token"),this.visible=!0,this.$http({url:this.$http.adornUrl("mall/class/list"),method:"get",params:this.$http.adornParams()}).then(function(a){var e=a.data;t.classificationItem=e&&0===e.code?e.list:[]}).then(function(){t.visible=!0,t.$nextTick(function(){t.$refs.dataForm.resetFields()})}).then(function(){t.dataForm.id&&t.$http({url:t.$http.adornUrl("mall/goods/info/"+t.dataForm.id),method:"get",params:t.$http.adornParams()}).then(function(a){var e=a.data;e&&0===e.code&&(t.dataForm.name=e.goods.name,t.dataForm.classification=e.goods.classificationId,t.dataForm.details=e.goods.details)})})},handleAvatarSuccess:function(a,t){console.log(a),this.imageUrl=a.img,console.log(this.imageUrl)},beforeAvatarUpload:function(a){var t="image/jpeg"===a.type||"image/png"===a.type,e=a.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG 格式或者 PNG 格式!"),e||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&e},dataFormSubmit:function(){var a=this;this.$refs.dataForm.validate(function(t){t&&a.$http({url:a.$http.adornUrl("/mall/goods/"+(a.dataForm.id?"update":"save")),method:"post",data:a.$http.adornData({goodsId:a.dataForm.id||void 0,name:a.dataForm.name,classificationId:a.dataForm.classification,details:a.dataForm.details,img:a.imageUrl})}).then(function(t){var e=t.data;e&&0===e.code?a.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){a.visible=!1,a.$emit("refreshDataList")}}):a.$message.error(e.msg)})})}}},o={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("el-dialog",{attrs:{title:a.dataForm.id?"修改":"新增","close-on-click-modal":!1,visible:a.visible},on:{"update:visible":function(t){a.visible=t}}},[e("el-form",{ref:"dataForm",attrs:{model:a.dataForm,rules:a.dataRule,"label-width":"80px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&a._k(t.keyCode,"enter",13,t.key,"Enter")?null:a.dataFormSubmit()}}},[e("el-form-item",{attrs:{label:"商品名",prop:"name"}},[e("el-input",{attrs:{placeholder:"商品名称"},model:{value:a.dataForm.name,callback:function(t){a.$set(a.dataForm,"name",t)},expression:"dataForm.name"}})],1),a._v(" "),e("el-form-item",{attrs:{label:"类别",prop:"classification"}},[e("el-select",{attrs:{placeholder:"请选择新的类别"},model:{value:a.dataForm.classification,callback:function(t){a.$set(a.dataForm,"classification",t)},expression:"dataForm.classification"}},a._l(a.classificationItem,function(a){return e("el-option",{key:a.classificationId,attrs:{label:a.classificationName,value:a.classificationId}})}),1)],1),a._v(" "),e("el-form-item",{attrs:{label:"图片",prop:"img"}},[e("el-upload",{staticClass:"avatar-uploader",attrs:{action:"proxyApi/mall/goods/fileUpload",headers:this.token,"show-file-list":!1,"on-success":a.handleAvatarSuccess,"before-upload":a.beforeAvatarUpload}},[a.imageUrl?e("img",{staticClass:"avatar",attrs:{src:a.imageUrl}}):e("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a._v(" "),e("el-form-item",{attrs:{label:"详细说明",prop:"details"}},[e("el-input",{attrs:{placeholder:"商品介绍"},model:{value:a.dataForm.details,callback:function(t){a.$set(a.dataForm,"details",t)},expression:"dataForm.details"}})],1)],1),a._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(t){a.visible=!1}}},[a._v("取消")]),a._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:function(t){return a.dataFormSubmit()}}},[a._v("确定")])],1)],1)},staticRenderFns:[]};var s=e("VU/8")(i,o,!1,function(a){e("zgsL")},null,null);t.default=s.exports},zgsL:function(a,t){}});
//# sourceMappingURL=6.dd13ba43d70ebbbba007.js.map